#!/bin/bash
set -e

echo "==== db-setup"
bin_path="backend-flask/bin"

# Stop the backend container to release database connections
echo "Stopping backend-flask..."
docker-compose stop backend-flask

# Run the database scripts
"$bin_path/db/drop"
"$bin_path/db/create"
"$bin_path/db/schema-load"
"$bin_path/db/seed"

# Restart the backend container
echo "Starting backend-flask..."
docker-compose up -d backend-flask

echo "Setup complete."